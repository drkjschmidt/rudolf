<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>spec4/SpectrumData.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>spec4/SpectrumData.h</h1>  </div>
</div>
<div class="contents">
<a href="SpectrumData_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#pragma once</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span>
<a name="l00003"></a>00003 <span class="preprocessor">#include &quot;<a class="code" href="conf__const_8h.html">conf_const.h</a>&quot;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &quot;wrapper.h&quot;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &quot;arraytypes.h&quot;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &quot;<a class="code" href="RPGarmCom_8h.html">RPGarmCom.h</a>&quot;</span>
<a name="l00007"></a>00007 <span class="comment">// #include &quot;CalibrationCurve.h&quot;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="keyword">class </span><a class="code" href="classCCalibrationCurve.html" title="Class to hold calibration data and calculate calibration curves.">CCalibrationCurve</a>;
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="comment">// static  CString CCalibrationCurve::formatFitInfo(unsigned int infotype,int ctype, double *cparm, int cplen, double crsqr);</span>
<a name="l00012"></a>00012 
<a name="l00014"></a>00014 <span class="comment">//</span>
<a name="l00017"></a>00017 <span class="comment"></span><span class="comment">//</span>
<a name="l00018"></a><a class="code" href="classCSpectrumData.html">00018</a> <span class="keyword">class </span><a class="code" href="classCSpectrumData.html" title="Class to hold spectrum data.">CSpectrumData</a>
<a name="l00019"></a>00019 {
<a name="l00020"></a>00020 <span class="keyword">public</span>:
<a name="l00021"></a>00021         <a class="code" href="classCSpectrumData.html#a83127145f1077f2873f4fb973999a111">CSpectrumData</a>(<span class="keywordtype">void</span>);
<a name="l00022"></a>00022         <a class="code" href="classCSpectrumData.html#a2ec716faa508a12f6ce4fead83182040">~CSpectrumData</a>(<span class="keywordtype">void</span>);
<a name="l00023"></a>00023 
<a name="l00025"></a>00025         <span class="comment">//</span>
<a name="l00027"></a><a class="code" href="classCSpectrumData.html#a035e008c928688a608c7ebed62466874">00027</a> <span class="comment"></span>        <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#a035e008c928688a608c7ebed62466874" title="Clear spectrum data.">clear</a>() { <a class="code" href="classCSpectrumData.html#ad09609599de7f2f14d8d78569dc2f1ab">valid_wv</a>=<a class="code" href="classCSpectrumData.html#a5e59d31e303692c437fdb09937ef88ff">valid_int</a>=<span class="keyword">false</span>; <a class="code" href="classCSpectrumData.html#a37f8129f4f3e277bccd5de6855eb6df7">spec_idx</a>=<a class="code" href="classCSpectrumData.html#a4ad75480bbfcc126e5c33c47021cc393">wcount</a>=0; <a class="code" href="classCSpectrumData.html#ae983387d5ee053605067fcd9c6de834d">wmin</a>=<a class="code" href="classCSpectrumData.html#a6f3d5bafa576e363c7cee48c2fd2612f">wmax</a>=<a class="code" href="classCSpectrumData.html#a3d8c558ec07ad4a7bb1f713810b823c1">imin</a>=<a class="code" href="classCSpectrumData.html#a00501108e9e51562df5bbe3fefdcd929">imax</a>=-1; }
<a name="l00028"></a>00028 
<a name="l00030"></a><a class="code" href="classCSpectrumData.html#a0b6c10bed83acd9d8ba2c27a66ab5376">00030</a>         <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classCSpectrumData.html#a0b6c10bed83acd9d8ba2c27a66ab5376" title="Check if this spectrum has any valid data.">is_valid</a>()    { <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a5e59d31e303692c437fdb09937ef88ff">valid_int</a>; }
<a name="l00032"></a><a class="code" href="classCSpectrumData.html#a0885ed0446e16b291827c41d060088d5">00032</a>         <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classCSpectrumData.html#a0885ed0446e16b291827c41d060088d5" title="Check if this spectrum has valid wavelength data (in addition to intensities).">is_valid_wv</a>() { <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#ad09609599de7f2f14d8d78569dc2f1ab">valid_wv</a>;  }
<a name="l00033"></a>00033 
<a name="l00034"></a>00034         <span class="keywordtype">bool</span> <a class="code" href="classCSpectrumData.html#a094ec6dc1684e9fc3a9c20e5868d5622">store</a>(<span class="keywordtype">int</span> idx, DoubleArray *Intensities, DoubleArray *Wavelengths=NULL, <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#acc551c43a27ec0448a0b24d53ddc2075" title="Concentration value (measured or userdefined).">conc</a>=-1);
<a name="l00035"></a><a class="code" href="classCSpectrumData.html#a13ccf66c11466444d81abd5bb5884353">00035</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#a13ccf66c11466444d81abd5bb5884353">storeDatatype</a>(CString stype) { <a class="code" href="classCSpectrumData.html#a1b8b73035641724a1ba9b3f9d05c4299" title="a comment line to identify spectrum sections">dtype</a>=stype; }
<a name="l00036"></a><a class="code" href="classCSpectrumData.html#a5282784ed720846868186e27eb6bb5df">00036</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#a5282784ed720846868186e27eb6bb5df">storeComments</a>(
<a name="l00037"></a>00037                 CString *slocn, 
<a name="l00038"></a>00038                 CString *scust, 
<a name="l00039"></a>00039                 CString *scomm,
<a name="l00040"></a>00040                 CString *spikm,
<a name="l00041"></a>00041                 CString *sdilu,
<a name="l00042"></a>00042                 CString *sffm1,
<a name="l00043"></a>00043                 CString *sffm2) {
<a name="l00044"></a>00044                         <span class="keywordflow">if</span> (slocn != NULL) { <a class="code" href="classCSpectrumData.html#a95bb2c2be68e6e8a75777b10b984bfdb">Location</a> = *slocn; }
<a name="l00045"></a>00045                         <span class="keywordflow">if</span> (scust != NULL) { <a class="code" href="classCSpectrumData.html#a18b8196a9ce67e89ba7a807b253ab003" title="Informational variables.">Customer</a> = *scust; }
<a name="l00046"></a>00046                         <span class="keywordflow">if</span> (scomm != NULL) { <a class="code" href="classCSpectrumData.html#a23f7d316920cc4d7fbc84648be3e9c13">Comment</a>  = *scomm; }
<a name="l00047"></a>00047                         <span class="keywordflow">if</span> (spikm != NULL) { <a class="code" href="classCSpectrumData.html#af738611c087144f76f46d2f9adb98e38">Pipekm</a>   = atof(spikm-&gt;GetString()); }
<a name="l00048"></a>00048                         <span class="keywordflow">if</span> (sdilu != NULL) { <a class="code" href="classCSpectrumData.html#ad4ff25d2211aa22c4d4d1de8c7a99603">Dilution</a> = atof(sdilu-&gt;GetString()); }
<a name="l00049"></a>00049                         <span class="keywordflow">if</span> (sffm1 != NULL) { <a class="code" href="classCSpectrumData.html#aabb7452fb1af9ea7e42efc17f40ab7ba">FF1</a>      = *sffm1; }
<a name="l00050"></a>00050                         <span class="keywordflow">if</span> (sffm2 != NULL) { <a class="code" href="classCSpectrumData.html#a44761d78a03f7d746abdef5403627049">FF2</a>      = *sffm2; }
<a name="l00051"></a>00051         }
<a name="l00052"></a>00052 
<a name="l00053"></a><a class="code" href="classCSpectrumData.html#aa5034f790acb1fe45e8c7b53d6e7134e">00053</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#aa5034f790acb1fe45e8c7b53d6e7134e">storeAcqInfo</a>(<span class="keywordtype">double</span> sitime,<span class="keywordtype">int</span> savg,<span class="keywordtype">int</span> sboxw) {
<a name="l00054"></a>00054                 <a class="code" href="classCSpectrumData.html#a925dd53b846689dfbb4dfc45d259c7e9">itime</a>=sitime;
<a name="l00055"></a>00055                 <a class="code" href="classCSpectrumData.html#af150a81336f7f2b38f273b9afbaed5c3">avg</a>=savg;
<a name="l00056"></a>00056                 <a class="code" href="classCSpectrumData.html#a77d71cf442dabd538a5d8cbdc0c8ab5e">boxw</a>=sboxw;
<a name="l00057"></a>00057         }
<a name="l00058"></a>00058 
<a name="l00059"></a><a class="code" href="classCSpectrumData.html#aa374ef482243fe9cd75293c9f38a5b3e">00059</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#aa374ef482243fe9cd75293c9f38a5b3e">storeConc</a>(<span class="keywordtype">double</span> sconc) { <a class="code" href="classCSpectrumData.html#acc551c43a27ec0448a0b24d53ddc2075" title="Concentration value (measured or userdefined).">conc</a>=sconc; }
<a name="l00060"></a><a class="code" href="classCSpectrumData.html#ae63b8a2bb87f1d8345a3731b39f34116">00060</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#ae63b8a2bb87f1d8345a3731b39f34116">storeCalInfo</a>(CString sname, CString sUFID, <span class="keywordtype">double</span> swavelen, 
<a name="l00061"></a>00061                 <span class="keywordtype">int</span> stype, <span class="keywordtype">double</span> *sparm, <span class="keywordtype">double</span> sRSquared,
<a name="l00062"></a>00062                 <span class="keywordtype">int</span> scc, <span class="keyword">const</span> <span class="keywordtype">double</span> *sccn, <span class="keyword">const</span> <span class="keywordtype">double</span> *scct,
<a name="l00063"></a>00063                 <span class="keywordtype">double</span> swl, <span class="keywordtype">double</span> swh, <span class="keywordtype">double</span> sel, <span class="keywordtype">double</span> seh) 
<a name="l00064"></a>00064         {
<a name="l00065"></a>00065                 <span class="keywordtype">int</span> ii;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067                 <a class="code" href="classCSpectrumData.html#ae0b7b8c53e009ebfa03064018be3884c" title="Name of calibration curve on which concentration is based.">calName</a>=sname;
<a name="l00068"></a>00068                 <a class="code" href="classCSpectrumData.html#a1fedda1f4c474b8e399bc0390bffab48">calUFID</a>=sUFID;
<a name="l00069"></a>00069                 <a class="code" href="classCSpectrumData.html#a0592a6aabad34a9107497426dae8c83c" title="Wavelength at which concentration was determined.">calWavelen</a>=swavelen;
<a name="l00070"></a>00070                 <a class="code" href="classCSpectrumData.html#ab7bf1eda2ea2df43a5fa771b24bb18c8" title="Calibration type to go with concentration.">calType</a>=stype;
<a name="l00071"></a>00071                 <span class="keywordflow">for</span> (ii=0; ii&lt;<a class="code" href="classCSpectrumData.html#ab7bf1eda2ea2df43a5fa771b24bb18c8" title="Calibration type to go with concentration.">calType</a> &amp;&amp; ii&lt;4; ii++)
<a name="l00072"></a>00072                         <a class="code" href="classCSpectrumData.html#aeb037dca76271fed78e56d2a770839ec" title="Array of calibration constants ... contains calType values.">calConst</a>[ii]=sparm[ii];
<a name="l00073"></a>00073                 <a class="code" href="classCSpectrumData.html#af58a08887d61f47025a58c010e795c88" title="calibration quality factor rqsuared">calRSquared</a>=sRSquared;
<a name="l00074"></a>00074                 <a class="code" href="classCSpectrumData.html#aa3fa478b3ed634cafb00225aafcf136b" title="actual calibration datapoints so we don&amp;#39;t need the calibration curve itself ...">calDataCount</a>=min(scc,<a class="code" href="conf__const_8h.html#a45dfda200273de93625df4e3c03547fa">MAX_CAL_SPEC</a>);
<a name="l00075"></a>00075                 <span class="keywordflow">for</span> (ii=0; ii&lt;<a class="code" href="classCSpectrumData.html#aa3fa478b3ed634cafb00225aafcf136b" title="actual calibration datapoints so we don&amp;#39;t need the calibration curve itself ...">calDataCount</a>; ii++)
<a name="l00076"></a>00076                 {
<a name="l00077"></a>00077                         <a class="code" href="classCSpectrumData.html#aa8be4bb61eba1061b182284528d39ab0">calConcns</a>[ii]=sccn[ii];
<a name="l00078"></a>00078                         <a class="code" href="classCSpectrumData.html#a71e009941c48149db24e601dce1aaacc">calCounts</a>[ii]=scct[ii];
<a name="l00079"></a>00079                 }
<a name="l00080"></a>00080                 <a class="code" href="classCSpectrumData.html#a3df4b08f19dc399c7258c1f58063f121">calWL</a>=swl;
<a name="l00081"></a>00081                 <a class="code" href="classCSpectrumData.html#a12b1698e9d0e4048270868630abb1036">calWH</a>=swh;
<a name="l00082"></a>00082                 <a class="code" href="classCSpectrumData.html#a2aef98fe50feed756f5dac805fdcf5ef" title="Warning levels in calibration.">calEL</a>=sel;
<a name="l00083"></a>00083                 <a class="code" href="classCSpectrumData.html#a6295b0ee3a35dc4f50a627c51a3da4fe">calEH</a>=seh;
<a name="l00084"></a>00084         }
<a name="l00085"></a>00085 
<a name="l00086"></a><a class="code" href="classCSpectrumData.html#a7246c10ec18b55342a0f5d037ce77bef">00086</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#a7246c10ec18b55342a0f5d037ce77bef">storeGpsLoc</a>(<span class="keywordtype">double</span> slat, <span class="keywordtype">double</span> slon, <span class="keywordtype">double</span> salt) {
<a name="l00087"></a>00087                 <span class="comment">// lat=slat;</span>
<a name="l00088"></a>00088                 <span class="comment">// lon=slon;</span>
<a name="l00089"></a>00089                 <span class="comment">// alt=salt;</span>
<a name="l00090"></a>00090                 <a class="code" href="classCSpectrumData.html#a9adf14d430b7b5ea5f6aebf1f4559f92">GPSinfo</a>.<a class="code" href="classCGPSData.html#a7fdad98ca21ad7c6681413ff38d9352c" title="Store data in class.">setData</a>(&amp;slat, &amp;slon, &amp;salt, NULL, NULL, NULL, NULL, (<span class="keywordtype">char</span> *)NULL);
<a name="l00091"></a>00091         }
<a name="l00092"></a><a class="code" href="classCSpectrumData.html#a6cf6246fda69ced5e2c91fa70549e70c">00092</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#a6cf6246fda69ced5e2c91fa70549e70c">storeGpsTime</a>(INT32 stime, INT32 sdate) {
<a name="l00093"></a>00093                 <span class="comment">// time=stime;</span>
<a name="l00094"></a>00094                 <span class="comment">// date=sdate;</span>
<a name="l00095"></a>00095                 <a class="code" href="classCSpectrumData.html#a9adf14d430b7b5ea5f6aebf1f4559f92">GPSinfo</a>.<a class="code" href="classCGPSData.html#a7fdad98ca21ad7c6681413ff38d9352c" title="Store data in class.">setData</a>(NULL, NULL, NULL, NULL, NULL, &amp;stime, &amp;sdate, (<span class="keywordtype">char</span> *)NULL);
<a name="l00096"></a>00096         }
<a name="l00097"></a><a class="code" href="classCSpectrumData.html#ac5b72ca9a7b7b5a4301f294cb4f2b867">00097</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#ac5b72ca9a7b7b5a4301f294cb4f2b867">storeGpsTime</a>(CTime timestamp) {
<a name="l00098"></a>00098                 <span class="comment">// time=stime;</span>
<a name="l00099"></a>00099                 <span class="comment">// date=sdate;</span>
<a name="l00100"></a>00100                 <a class="code" href="classCSpectrumData.html#a9adf14d430b7b5ea5f6aebf1f4559f92">GPSinfo</a>.<a class="code" href="classCGPSData.html#a7fdad98ca21ad7c6681413ff38d9352c" title="Store data in class.">setData</a>(NULL, NULL, NULL, NULL, NULL, &amp;timestamp, (CString *)NULL);
<a name="l00101"></a>00101         }
<a name="l00102"></a><a class="code" href="classCSpectrumData.html#a1050a3cf6a46b84cdbdca44b98c970fc">00102</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#a1050a3cf6a46b84cdbdca44b98c970fc">storeSysTime</a>(SYSTEMTIME <span class="keyword">set</span>) { <a class="code" href="classCSpectrumData.html#a5fc9566fc8888bedb1f5df2872834ab7">ClockInfo</a>=<span class="keyword">set</span>; }
<a name="l00103"></a>00103 
<a name="l00104"></a><a class="code" href="classCSpectrumData.html#a4eff3c5fbd12f362a9c92143483e0e85">00104</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#a4eff3c5fbd12f362a9c92143483e0e85">storeSpecName</a>(CString <span class="keyword">set</span>) { <a class="code" href="classCSpectrumData.html#a8adfb78843d111e807db93f139781b26" title="Name and Serial of spectrometer.">specName</a>=<span class="keyword">set</span>; }
<a name="l00105"></a><a class="code" href="classCSpectrumData.html#a33c0fb36a0cc85b4ef2a6457e754eb23">00105</a>         <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#a33c0fb36a0cc85b4ef2a6457e754eb23">storeSpecSerial</a>(CString <span class="keyword">set</span>) { <a class="code" href="classCSpectrumData.html#a4698c08da29550d0ebd9c17bf980b6bf">specSerial</a>=<span class="keyword">set</span>; }
<a name="l00106"></a>00106 
<a name="l00107"></a><a class="code" href="classCSpectrumData.html#a812b56940bec6357a9a8501feff23628">00107</a>         <span class="keyword">inline</span> DoubleArray <a class="code" href="classCSpectrumData.html#a812b56940bec6357a9a8501feff23628">getWavelengths</a>() { <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#ad09609599de7f2f14d8d78569dc2f1ab">valid_wv</a>)  <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a1cf704a000bea52aafa425caca920cf1" title="Actual wavelengths [nm] at which spectrum was measured.">wavelengths</a>; <span class="keywordflow">return</span> DoubleArray(); }
<a name="l00108"></a><a class="code" href="classCSpectrumData.html#a889c7760331b556e03cb349c782bcba5">00108</a>         <span class="keyword">inline</span> DoubleArray <a class="code" href="classCSpectrumData.html#a889c7760331b556e03cb349c782bcba5">getIntensities</a>() { <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#a5e59d31e303692c437fdb09937ef88ff">valid_int</a>) <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#af79aeb3250bbbe101327869ee9831b0f" title="Associated intensities [counts].">intensities</a>; <span class="keywordflow">return</span> DoubleArray(); }
<a name="l00109"></a>00109 
<a name="l00110"></a><a class="code" href="classCSpectrumData.html#aa492fe388aee51cc74ed0cc7b68844db">00110</a>         <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#aa492fe388aee51cc74ed0cc7b68844db">getMinW</a>() { <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#ad09609599de7f2f14d8d78569dc2f1ab">valid_wv</a>)  <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#ae983387d5ee053605067fcd9c6de834d">wmin</a>; <span class="keywordflow">return</span> -1; }
<a name="l00111"></a><a class="code" href="classCSpectrumData.html#aafe9f754ffe9d54c82a4c7bcb2ae3858">00111</a>         <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#aafe9f754ffe9d54c82a4c7bcb2ae3858">getCalW</a>() { <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#ad09609599de7f2f14d8d78569dc2f1ab">valid_wv</a>)  <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a0592a6aabad34a9107497426dae8c83c" title="Wavelength at which concentration was determined.">calWavelen</a>; <span class="keywordflow">return</span> -1; }
<a name="l00112"></a><a class="code" href="classCSpectrumData.html#a2d4dafcddf484d3d8794b1fdc01e716a">00112</a>         <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a2d4dafcddf484d3d8794b1fdc01e716a">getMaxW</a>() { <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#ad09609599de7f2f14d8d78569dc2f1ab">valid_wv</a>)  <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a6f3d5bafa576e363c7cee48c2fd2612f">wmax</a>; <span class="keywordflow">return</span> -1; }
<a name="l00113"></a><a class="code" href="classCSpectrumData.html#a992e97e1f517d6099d4dc33c36168fa3">00113</a>         <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a992e97e1f517d6099d4dc33c36168fa3">getMinI</a>() { <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#a5e59d31e303692c437fdb09937ef88ff">valid_int</a>) <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a3d8c558ec07ad4a7bb1f713810b823c1">imin</a>; <span class="keywordflow">return</span> -1; }
<a name="l00114"></a><a class="code" href="classCSpectrumData.html#a9bc317aedb590999b734166e289b8e91">00114</a>         <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a9bc317aedb590999b734166e289b8e91">getMaxI</a>() { <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#a5e59d31e303692c437fdb09937ef88ff">valid_int</a>) <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a00501108e9e51562df5bbe3fefdcd929">imax</a>; <span class="keywordflow">return</span> -1; }
<a name="l00115"></a><a class="code" href="classCSpectrumData.html#aed7d9d942026e37b873fb5f3700b98fd">00115</a>         <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#aed7d9d942026e37b873fb5f3700b98fd">getConc</a>() {                <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#acc551c43a27ec0448a0b24d53ddc2075" title="Concentration value (measured or userdefined).">conc</a>;            }
<a name="l00116"></a>00116 
<a name="l00119"></a>00119         <span class="comment">//</span>
<a name="l00120"></a><a class="code" href="classCSpectrumData.html#a5d1476ef5ff0a58c1427de8b7329f5e4">00120</a>         <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classCSpectrumData.html#a5d1476ef5ff0a58c1427de8b7329f5e4">getXY</a>(<span class="keywordtype">double</span> *wv, <span class="keywordtype">double</span> *in) {
<a name="l00121"></a>00121                 <span class="keywordtype">int</span> ii;
<a name="l00122"></a>00122                 <span class="keywordtype">double</span> tw;
<a name="l00123"></a>00123 
<a name="l00124"></a>00124                 <span class="keywordflow">if</span> ((! <a class="code" href="classCSpectrumData.html#ad09609599de7f2f14d8d78569dc2f1ab">valid_wv</a>) || (wv==NULL) || (in==NULL))
<a name="l00125"></a>00125                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127                 <span class="keywordflow">if</span> ((*wv&lt;<a class="code" href="classCSpectrumData.html#ae983387d5ee053605067fcd9c6de834d">wmin</a>) || (*wv&gt;<a class="code" href="classCSpectrumData.html#a6f3d5bafa576e363c7cee48c2fd2612f">wmax</a>))
<a name="l00128"></a>00128                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00129"></a>00129 
<a name="l00130"></a>00130                 <span class="comment">// Guess approximate index ... unfortunately the scale is not linear ...</span>
<a name="l00131"></a>00131                 ii=(int)((<a class="code" href="classCSpectrumData.html#a4ad75480bbfcc126e5c33c47021cc393">wcount</a>-1)*((*wv-<a class="code" href="classCSpectrumData.html#ae983387d5ee053605067fcd9c6de834d">wmin</a>)/(<a class="code" href="classCSpectrumData.html#a6f3d5bafa576e363c7cee48c2fd2612f">wmax</a>-<a class="code" href="classCSpectrumData.html#ae983387d5ee053605067fcd9c6de834d">wmin</a>)));
<a name="l00132"></a>00132                 tw = <a class="code" href="classCSpectrumData.html#a1cf704a000bea52aafa425caca920cf1" title="Actual wavelengths [nm] at which spectrum was measured.">wavelengths</a>.getDoubleValues()[ii];
<a name="l00133"></a>00133 
<a name="l00134"></a>00134                 <span class="comment">// ... so now we need to search ...</span>
<a name="l00135"></a>00135                 <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#a1cf704a000bea52aafa425caca920cf1" title="Actual wavelengths [nm] at which spectrum was measured.">wavelengths</a>.getDoubleValues()[ii] &gt; *wv) {
<a name="l00136"></a>00136                         <span class="keywordflow">for</span> ( ; ii&gt;=0; ii--)
<a name="l00137"></a>00137                                 <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#a1cf704a000bea52aafa425caca920cf1" title="Actual wavelengths [nm] at which spectrum was measured.">wavelengths</a>.getDoubleValues()[ii] &lt;= *wv)
<a name="l00138"></a>00138                                         <span class="keywordflow">break</span>;
<a name="l00139"></a>00139                 } <span class="keywordflow">else</span> {
<a name="l00140"></a>00140                         <span class="keywordflow">for</span> ( ; ii&lt;=<a class="code" href="classCSpectrumData.html#a4ad75480bbfcc126e5c33c47021cc393">wcount</a>; ii++)
<a name="l00141"></a>00141                                 <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#a1cf704a000bea52aafa425caca920cf1" title="Actual wavelengths [nm] at which spectrum was measured.">wavelengths</a>.getDoubleValues()[ii] &gt; *wv)
<a name="l00142"></a>00142                                         <span class="keywordflow">break</span>;
<a name="l00143"></a>00143                         ii--;
<a name="l00144"></a>00144                 }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146                 <span class="comment">// ... make sure we limit to legal indexes ...</span>
<a name="l00147"></a>00147                 ii=min(ii,<a class="code" href="classCSpectrumData.html#a4ad75480bbfcc126e5c33c47021cc393">wcount</a>-1);
<a name="l00148"></a>00148                 ii=max(ii,       0);
<a name="l00149"></a>00149 
<a name="l00150"></a>00150                 <span class="comment">// ... finally check which one is closer ...</span>
<a name="l00151"></a>00151                 <span class="keywordflow">if</span> ((ii&lt;<a class="code" href="classCSpectrumData.html#a4ad75480bbfcc126e5c33c47021cc393">wcount</a>-1) &amp;&amp; ((*wv - <a class="code" href="classCSpectrumData.html#a1cf704a000bea52aafa425caca920cf1" title="Actual wavelengths [nm] at which spectrum was measured.">wavelengths</a>.getDoubleValues()[ii]) &gt; (<a class="code" href="classCSpectrumData.html#a1cf704a000bea52aafa425caca920cf1" title="Actual wavelengths [nm] at which spectrum was measured.">wavelengths</a>.getDoubleValues()[ii+1] - *wv)))
<a name="l00152"></a>00152                         ii++;
<a name="l00153"></a>00153 
<a name="l00154"></a>00154                 *wv = <a class="code" href="classCSpectrumData.html#a1cf704a000bea52aafa425caca920cf1" title="Actual wavelengths [nm] at which spectrum was measured.">wavelengths</a>.getDoubleValues()[ii];
<a name="l00155"></a>00155                 *in = <a class="code" href="classCSpectrumData.html#af79aeb3250bbbe101327869ee9831b0f" title="Associated intensities [counts].">intensities</a>.getDoubleValues()[ii];
<a name="l00156"></a>00156                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00157"></a>00157         }
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 
<a name="l00161"></a><a class="code" href="classCSpectrumData.html#a73ffc6f777304a9ab71f9f2242abd293">00161</a>         <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classCSpectrumData.html#a73ffc6f777304a9ab71f9f2242abd293">getSpec</a>() { <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#a5e59d31e303692c437fdb09937ef88ff">valid_int</a>) <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a37f8129f4f3e277bccd5de6855eb6df7">spec_idx</a>; <span class="keywordflow">return</span> -1; }
<a name="l00162"></a>00162 
<a name="l00163"></a><a class="code" href="classCSpectrumData.html#ae68ed5a190b3b2a129dccc50a5fd5de0">00163</a>         <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classCSpectrumData.html#ae68ed5a190b3b2a129dccc50a5fd5de0">getCount</a>() { <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#a5e59d31e303692c437fdb09937ef88ff">valid_int</a>) <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a4ad75480bbfcc126e5c33c47021cc393">wcount</a>; <span class="keywordflow">return</span> 0; }
<a name="l00164"></a>00164 
<a name="l00166"></a>00166         <span class="comment">//</span>
<a name="l00169"></a><a class="code" href="classCSpectrumData.html#aa387f7d2542863db15d57173f83fa359">00169</a> <span class="comment"></span>        <span class="keyword">enum</span> <a class="code" href="classCSpectrumData.html#aa387f7d2542863db15d57173f83fa359" title="Define output style of serialize.">SerializeModes</a> {
<a name="l00170"></a><a class="code" href="classCSpectrumData.html#aa387f7d2542863db15d57173f83fa359a7449377cd31a13eb20d057072a195aeb">00170</a>                 <a class="code" href="classCSpectrumData.html#aa387f7d2542863db15d57173f83fa359a7449377cd31a13eb20d057072a195aeb">outputCSV</a> =   (<span class="keywordtype">unsigned</span> char) 0x01,
<a name="l00171"></a><a class="code" href="classCSpectrumData.html#aa387f7d2542863db15d57173f83fa359a18b57f288fc3c5e9c4984d7873d9266c">00171</a>                 <a class="code" href="classCSpectrumData.html#aa387f7d2542863db15d57173f83fa359a18b57f288fc3c5e9c4984d7873d9266c">outputXML</a> =   (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) 0x02,
<a name="l00172"></a>00172         };
<a name="l00173"></a>00173 
<a name="l00174"></a>00174         <span class="comment">//@name I/O functions</span>
<a name="l00176"></a>00176 <span class="comment"></span>
<a name="l00177"></a>00177         <span class="keywordtype">bool</span> <a class="code" href="classCSpectrumData.html#ad92548b0354589f098e783da9ee2c615" title="Save to file.">Save</a>(CString *filename);
<a name="l00178"></a>00178 
<a name="l00180"></a>00180         <span class="keywordtype">bool</span> <a class="code" href="classCSpectrumData.html#a2cef64912d299f8a6665079c31c54e2b" title="Load from file.">Load</a>(CString *filename);
<a name="l00181"></a>00181 
<a name="l00183"></a>00183         CString <a class="code" href="classCSpectrumData.html#ae8126ddec2ee640714c124bd91364516" title="Create serialized data for save function.">serializeData</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> modes);
<a name="l00184"></a>00184 
<a name="l00186"></a>00186         <span class="keywordtype">bool</span> <a class="code" href="classCSpectrumData.html#a46883fa59c6cdf7e8037a0913865bf0b" title="Convert serialized data from load function to calibration curve contents.">deserializeData</a>(CString data, <span class="keywordtype">int</span> &amp;lpos, <span class="keywordtype">int</span> &amp;llpos);
<a name="l00188"></a>00188 
<a name="l00190"></a>00190         <a class="code" href="classCSpectrumData.html" title="Class to hold spectrum data.">CSpectrumData</a> <a class="code" href="classCSpectrumData.html#a687fe9bea67f053428d84d82a5bccea0" title="Subtraction operator for programming convenience.">operator-</a>(<a class="code" href="classCSpectrumData.html" title="Class to hold spectrum data.">CSpectrumData</a> &amp;right);
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="classCSpectrumData.html#abdbd9298afe42940b4a67e2735bb77b8">00192</a>         <span class="keyword">const</span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#abdbd9298afe42940b4a67e2735bb77b8">getPipeKm</a>() { <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#af738611c087144f76f46d2f9adb98e38">Pipekm</a>; }
<a name="l00193"></a><a class="code" href="classCSpectrumData.html#a0dc6cf15eae66ee85b208ab228cb9d81">00193</a>         <span class="keyword">const</span> <span class="keyword">inline</span> CString <a class="code" href="classCSpectrumData.html#a0dc6cf15eae66ee85b208ab228cb9d81">getPipeKmStr</a>() { CString tval; tval.Format(_T(<span class="stringliteral">&quot;%g&quot;</span>),<a class="code" href="classCSpectrumData.html#af738611c087144f76f46d2f9adb98e38">Pipekm</a>); <span class="keywordflow">return</span> tval; }
<a name="l00194"></a><a class="code" href="classCSpectrumData.html#a8d5603a6a16f85675877b538f959ef06">00194</a>         <span class="keyword">const</span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a8d5603a6a16f85675877b538f959ef06">getDilution</a>() { <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#ad4ff25d2211aa22c4d4d1de8c7a99603">Dilution</a>; }
<a name="l00195"></a><a class="code" href="classCSpectrumData.html#ac4d2e65a32bb97f701ac981c188ae9e7">00195</a>         <span class="keyword">const</span> <span class="keyword">inline</span> CString <a class="code" href="classCSpectrumData.html#ac4d2e65a32bb97f701ac981c188ae9e7">getDilutionStr</a>() { CString tval; tval.Format(_T(<span class="stringliteral">&quot;%g&quot;</span>),<a class="code" href="classCSpectrumData.html#ad4ff25d2211aa22c4d4d1de8c7a99603">Dilution</a>); <span class="keywordflow">return</span> tval; }
<a name="l00196"></a><a class="code" href="classCSpectrumData.html#ad20ae12fdc5d85e3acaba66d6f928abe">00196</a>         <span class="keyword">inline</span> CString <a class="code" href="classCSpectrumData.html#ad20ae12fdc5d85e3acaba66d6f928abe">formatLoc</a>() { <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a9adf14d430b7b5ea5f6aebf1f4559f92">GPSinfo</a>.<a class="code" href="classCGPSData.html#acc4a072edd7468a6b63c9413b706d1c9">formatLoc</a>(); }
<a name="l00197"></a><a class="code" href="classCSpectrumData.html#a9148976899393b383e94e53508d7e2fd">00197</a>         <span class="keyword">inline</span> CString <a class="code" href="classCSpectrumData.html#a9148976899393b383e94e53508d7e2fd">formatTimeStamp</a>() { 
<a name="l00198"></a>00198                 CString tval; 
<a name="l00199"></a>00199 
<a name="l00200"></a>00200                 <span class="comment">// Use GPS time if possible</span>
<a name="l00201"></a>00201                 <span class="keywordflow">if</span> (<a class="code" href="classCSpectrumData.html#a9adf14d430b7b5ea5f6aebf1f4559f92">GPSinfo</a>.<a class="code" href="classCGPSData.html#a711acc6ad968a80cfc568955c1f3c064" title="Retrieve time [int32 = hhmmss] ... return false if not known.">getTime</a>(NULL))
<a name="l00202"></a>00202                 {
<a name="l00203"></a>00203                         tval=<a class="code" href="classCSpectrumData.html#a9adf14d430b7b5ea5f6aebf1f4559f92">GPSinfo</a>.<a class="code" href="classCGPSData.html#af3bfb72e6274e4c0f5cf7a8663cac1a4">formatTime</a>();
<a name="l00204"></a>00204                         tval.Append(<span class="stringliteral">&quot; &quot;</span>);
<a name="l00205"></a>00205                         tval.Append(<a class="code" href="classCSpectrumData.html#a9adf14d430b7b5ea5f6aebf1f4559f92">GPSinfo</a>.<a class="code" href="classCGPSData.html#ada2f10d46084a5351f6beb2e8f7b8a0d">formatDate</a>());
<a name="l00206"></a>00206                 }
<a name="l00207"></a>00207                 <span class="comment">// ... if we don&#39;t have GPS time, fall back to system time ...</span>
<a name="l00208"></a>00208                 <span class="keywordflow">else</span>
<a name="l00209"></a>00209                 {
<a name="l00210"></a>00210                         tval.Format(_T(<span class="stringliteral">&quot;%02d:%02d:%02d UTC  &quot;</span>),
<a name="l00211"></a>00211                                 <a class="code" href="classCSpectrumData.html#a5fc9566fc8888bedb1f5df2872834ab7">ClockInfo</a>.wHour,
<a name="l00212"></a>00212                                 <a class="code" href="classCSpectrumData.html#a5fc9566fc8888bedb1f5df2872834ab7">ClockInfo</a>.wMinute,
<a name="l00213"></a>00213                                 <a class="code" href="classCSpectrumData.html#a5fc9566fc8888bedb1f5df2872834ab7">ClockInfo</a>.wSecond);
<a name="l00214"></a>00214                         tval.AppendFormat(_T(<span class="stringliteral">&quot;%04d-%02d-%02d &quot;</span>),
<a name="l00215"></a>00215                                 <a class="code" href="classCSpectrumData.html#a5fc9566fc8888bedb1f5df2872834ab7">ClockInfo</a>.wYear,
<a name="l00216"></a>00216                                 <a class="code" href="classCSpectrumData.html#a5fc9566fc8888bedb1f5df2872834ab7">ClockInfo</a>.wMonth,
<a name="l00217"></a>00217                                 <a class="code" href="classCSpectrumData.html#a5fc9566fc8888bedb1f5df2872834ab7">ClockInfo</a>.wDay);
<a name="l00218"></a>00218                 }
<a name="l00219"></a>00219                 <span class="keywordflow">return</span> tval;
<a name="l00220"></a>00220         }
<a name="l00221"></a><a class="code" href="classCSpectrumData.html#a3ac6a6f0f3cdce11bcc3c2d523284c0f">00221</a>         <span class="keyword">inline</span> CString <a class="code" href="classCSpectrumData.html#a3ac6a6f0f3cdce11bcc3c2d523284c0f">getComment</a>() { <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a23f7d316920cc4d7fbc84648be3e9c13">Comment</a>; }
<a name="l00222"></a><a class="code" href="classCSpectrumData.html#acb0de37fac5694b4fc9a55c679a9d71b">00222</a>         <span class="keyword">inline</span> CString <a class="code" href="classCSpectrumData.html#acb0de37fac5694b4fc9a55c679a9d71b">getCustomer</a>() { <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a18b8196a9ce67e89ba7a807b253ab003" title="Informational variables.">Customer</a>; }
<a name="l00223"></a><a class="code" href="classCSpectrumData.html#afcf57b1a56307f1fe2d0e7700b3a305e">00223</a>         <span class="keyword">inline</span> CString <a class="code" href="classCSpectrumData.html#afcf57b1a56307f1fe2d0e7700b3a305e">getLocation</a>() { <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a95bb2c2be68e6e8a75777b10b984bfdb">Location</a>; }
<a name="l00224"></a><a class="code" href="classCSpectrumData.html#aae050d0d0dc7d9201d8fbbb31e81e2f8">00224</a>         <span class="keyword">inline</span> CString <a class="code" href="classCSpectrumData.html#aae050d0d0dc7d9201d8fbbb31e81e2f8">getCalname</a>() { <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#ae0b7b8c53e009ebfa03064018be3884c" title="Name of calibration curve on which concentration is based.">calName</a>; }
<a name="l00225"></a><a class="code" href="classCSpectrumData.html#a2ae39f66269f0af56d418c4bcfb9dfb7">00225</a>         <span class="keyword">inline</span> <a class="code" href="classCGPSData.html" title="Store and manipulate GPS data (time, date, location).">CGPSData</a> <a class="code" href="classCSpectrumData.html#a2ae39f66269f0af56d418c4bcfb9dfb7">getGPSData</a>() { <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a9adf14d430b7b5ea5f6aebf1f4559f92">GPSinfo</a>; }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227         <span class="comment">// not inlined to avoid cross-references ... </span>
<a name="l00228"></a>00228         CString <a class="code" href="classCSpectrumData.html#adbfee26fbd16da25611b9e35690516ea">formatFitInfo</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> infotype);
<a name="l00229"></a>00229 
<a name="l00231"></a>00231         <span class="comment">//</span>
<a name="l00240"></a>00240 <span class="comment"></span>        <span class="keywordtype">bool</span> <a class="code" href="classCSpectrumData.html#a5d8ef18534b4841dd4019819b9856988" title="Draw the spectrum.">PaintSpectrum</a>(CDC *pDC, LPRECT myrect,CPen *pen,
<a name="l00241"></a>00241                                                 <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#ae983387d5ee053605067fcd9c6de834d">wmin</a>, <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a6f3d5bafa576e363c7cee48c2fd2612f">wmax</a>,
<a name="l00242"></a>00242                                                 <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a3d8c558ec07ad4a7bb1f713810b823c1">imin</a>, <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a00501108e9e51562df5bbe3fefdcd929">imax</a>, 
<a name="l00243"></a>00243                                                 <span class="keywordtype">bool</span> redraw_axis,
<a name="l00244"></a>00244                                                 <span class="keywordtype">bool</span> wavlen_line);
<a name="l00245"></a>00245 
<a name="l00247"></a>00247         <span class="comment">//</span>
<a name="l00250"></a><a class="code" href="classCSpectrumData.html#a3969636e2ec9445cd960240b08e7272a">00250</a> <span class="comment"></span>        <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classCSpectrumData.html#a5d8ef18534b4841dd4019819b9856988" title="Draw the spectrum.">PaintSpectrum</a>(CDC *pDC, LPRECT myrect,CPen *pen,
<a name="l00251"></a>00251                 <span class="keywordtype">bool</span> wavlen_line) 
<a name="l00252"></a>00252         {
<a name="l00253"></a>00253                 <span class="keywordflow">return</span> <a class="code" href="classCSpectrumData.html#a5d8ef18534b4841dd4019819b9856988" title="Draw the spectrum.">PaintSpectrum</a>(pDC,myrect,pen,<a class="code" href="classCSpectrumData.html#aa492fe388aee51cc74ed0cc7b68844db">getMinW</a>(),<a class="code" href="classCSpectrumData.html#a2d4dafcddf484d3d8794b1fdc01e716a">getMaxW</a>(),<a class="code" href="classCSpectrumData.html#a992e97e1f517d6099d4dc33c36168fa3">getMinI</a>(),<a class="code" href="classCSpectrumData.html#a9bc317aedb590999b734166e289b8e91">getMaxI</a>(),<span class="keyword">true</span>,wavlen_line);
<a name="l00254"></a>00254         }
<a name="l00255"></a>00255 
<a name="l00257"></a>00257         <span class="comment">//</span>
<a name="l00264"></a>00264 <span class="comment"></span>        <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#aa840dcc3e01cd8e642010436bf980847" title="Create a (print) report.">PaintReport</a>(CDC *pDC, CPrintInfo *pInfo, LPRECT myrect);
<a name="l00265"></a>00265 
<a name="l00267"></a>00267         <span class="keywordtype">void</span> <a class="code" href="classCSpectrumData.html#a851f02575604b93645947e6b2e3ab2c0" title="Draw the *included* calibration curve.">PaintCalCurve</a>(CDC *pDC, LPRECT myrect);
<a name="l00268"></a>00268 
<a name="l00269"></a>00269 <span class="keyword">private</span>:
<a name="l00270"></a>00270         
<a name="l00272"></a><a class="code" href="classCSpectrumData.html#a1b8b73035641724a1ba9b3f9d05c4299">00272</a>         CString <a class="code" href="classCSpectrumData.html#a1b8b73035641724a1ba9b3f9d05c4299" title="a comment line to identify spectrum sections">dtype</a>;
<a name="l00273"></a>00273 
<a name="l00275"></a><a class="code" href="classCSpectrumData.html#a1cf704a000bea52aafa425caca920cf1">00275</a>         DoubleArray <a class="code" href="classCSpectrumData.html#a1cf704a000bea52aafa425caca920cf1" title="Actual wavelengths [nm] at which spectrum was measured.">wavelengths</a>;
<a name="l00277"></a><a class="code" href="classCSpectrumData.html#af79aeb3250bbbe101327869ee9831b0f">00277</a>         DoubleArray <a class="code" href="classCSpectrumData.html#af79aeb3250bbbe101327869ee9831b0f" title="Associated intensities [counts].">intensities</a>;
<a name="l00278"></a>00278 
<a name="l00279"></a><a class="code" href="classCSpectrumData.html#ad09609599de7f2f14d8d78569dc2f1ab">00279</a>         <span class="keywordtype">bool</span> <a class="code" href="classCSpectrumData.html#ad09609599de7f2f14d8d78569dc2f1ab">valid_wv</a>,<a class="code" href="classCSpectrumData.html#a5e59d31e303692c437fdb09937ef88ff">valid_int</a>;
<a name="l00280"></a><a class="code" href="classCSpectrumData.html#a37f8129f4f3e277bccd5de6855eb6df7">00280</a>         <span class="keywordtype">int</span> <a class="code" href="classCSpectrumData.html#a37f8129f4f3e277bccd5de6855eb6df7">spec_idx</a>;
<a name="l00281"></a>00281 
<a name="l00283"></a>00283         <span class="comment">//</span>
<a name="l00284"></a><a class="code" href="classCSpectrumData.html#a18b8196a9ce67e89ba7a807b253ab003">00284</a>         CString <a class="code" href="classCSpectrumData.html#a18b8196a9ce67e89ba7a807b253ab003" title="Informational variables.">Customer</a>;
<a name="l00285"></a><a class="code" href="classCSpectrumData.html#a95bb2c2be68e6e8a75777b10b984bfdb">00285</a>         CString <a class="code" href="classCSpectrumData.html#a95bb2c2be68e6e8a75777b10b984bfdb">Location</a>;
<a name="l00286"></a><a class="code" href="classCSpectrumData.html#a23f7d316920cc4d7fbc84648be3e9c13">00286</a>         CString <a class="code" href="classCSpectrumData.html#a23f7d316920cc4d7fbc84648be3e9c13">Comment</a>;
<a name="l00287"></a><a class="code" href="classCSpectrumData.html#af738611c087144f76f46d2f9adb98e38">00287</a>         <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#af738611c087144f76f46d2f9adb98e38">Pipekm</a>;
<a name="l00288"></a><a class="code" href="classCSpectrumData.html#ad4ff25d2211aa22c4d4d1de8c7a99603">00288</a>         <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#ad4ff25d2211aa22c4d4d1de8c7a99603">Dilution</a>;
<a name="l00289"></a><a class="code" href="classCSpectrumData.html#a44761d78a03f7d746abdef5403627049">00289</a>         CString <a class="code" href="classCSpectrumData.html#aabb7452fb1af9ea7e42efc17f40ab7ba">FF1</a>,<a class="code" href="classCSpectrumData.html#a44761d78a03f7d746abdef5403627049">FF2</a>;
<a name="l00290"></a>00290 
<a name="l00291"></a><a class="code" href="classCSpectrumData.html#a9adf14d430b7b5ea5f6aebf1f4559f92">00291</a>         <a class="code" href="classCGPSData.html" title="Store and manipulate GPS data (time, date, location).">CGPSData</a> <a class="code" href="classCSpectrumData.html#a9adf14d430b7b5ea5f6aebf1f4559f92">GPSinfo</a>;
<a name="l00292"></a><a class="code" href="classCSpectrumData.html#a5fc9566fc8888bedb1f5df2872834ab7">00292</a>         SYSTEMTIME <a class="code" href="classCSpectrumData.html#a5fc9566fc8888bedb1f5df2872834ab7">ClockInfo</a>;
<a name="l00293"></a>00293 
<a name="l00294"></a>00294         <span class="comment">// double lat,lon,alt;</span>
<a name="l00295"></a>00295         <span class="comment">// INT32 time,date;</span>
<a name="l00296"></a>00296 
<a name="l00298"></a><a class="code" href="classCSpectrumData.html#a4698c08da29550d0ebd9c17bf980b6bf">00298</a>         CString <a class="code" href="classCSpectrumData.html#a8adfb78843d111e807db93f139781b26" title="Name and Serial of spectrometer.">specName</a>, <a class="code" href="classCSpectrumData.html#a4698c08da29550d0ebd9c17bf980b6bf">specSerial</a>;
<a name="l00299"></a>00299 
<a name="l00300"></a>00300 
<a name="l00302"></a>00302         <span class="comment">//</span>
<a name="l00303"></a><a class="code" href="classCSpectrumData.html#ae0b7b8c53e009ebfa03064018be3884c">00303</a>         CString <a class="code" href="classCSpectrumData.html#ae0b7b8c53e009ebfa03064018be3884c" title="Name of calibration curve on which concentration is based.">calName</a>;
<a name="l00304"></a><a class="code" href="classCSpectrumData.html#a1fedda1f4c474b8e399bc0390bffab48">00304</a>         CString <a class="code" href="classCSpectrumData.html#a1fedda1f4c474b8e399bc0390bffab48">calUFID</a>;
<a name="l00305"></a>00305 
<a name="l00307"></a><a class="code" href="classCSpectrumData.html#a0592a6aabad34a9107497426dae8c83c">00307</a>         <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a0592a6aabad34a9107497426dae8c83c" title="Wavelength at which concentration was determined.">calWavelen</a>;
<a name="l00308"></a>00308 
<a name="l00310"></a>00310         <span class="comment">//</span>
<a name="l00316"></a><a class="code" href="classCSpectrumData.html#ab7bf1eda2ea2df43a5fa771b24bb18c8">00316</a> <span class="comment"></span>        <span class="keywordtype">int</span> <a class="code" href="classCSpectrumData.html#ab7bf1eda2ea2df43a5fa771b24bb18c8" title="Calibration type to go with concentration.">calType</a>;
<a name="l00317"></a>00317 
<a name="l00319"></a><a class="code" href="classCSpectrumData.html#aeb037dca76271fed78e56d2a770839ec">00319</a>         <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#aeb037dca76271fed78e56d2a770839ec" title="Array of calibration constants ... contains calType values.">calConst</a>[4];
<a name="l00320"></a>00320 
<a name="l00322"></a><a class="code" href="classCSpectrumData.html#af58a08887d61f47025a58c010e795c88">00322</a>         <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#af58a08887d61f47025a58c010e795c88" title="calibration quality factor rqsuared">calRSquared</a>;
<a name="l00323"></a>00323 
<a name="l00325"></a><a class="code" href="classCSpectrumData.html#aa3fa478b3ed634cafb00225aafcf136b">00325</a>         <span class="keywordtype">int</span> <a class="code" href="classCSpectrumData.html#aa3fa478b3ed634cafb00225aafcf136b" title="actual calibration datapoints so we don&amp;#39;t need the calibration curve itself ...">calDataCount</a>;
<a name="l00326"></a><a class="code" href="classCSpectrumData.html#aa8be4bb61eba1061b182284528d39ab0">00326</a>         <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#aa8be4bb61eba1061b182284528d39ab0">calConcns</a>[MAX_CAL_SPEC];
<a name="l00327"></a><a class="code" href="classCSpectrumData.html#a71e009941c48149db24e601dce1aaacc">00327</a>         <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a71e009941c48149db24e601dce1aaacc">calCounts</a>[MAX_CAL_SPEC];
<a name="l00328"></a>00328 
<a name="l00330"></a><a class="code" href="classCSpectrumData.html#a3df4b08f19dc399c7258c1f58063f121">00330</a>         <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a2aef98fe50feed756f5dac805fdcf5ef" title="Warning levels in calibration.">calEL</a>, <a class="code" href="classCSpectrumData.html#a6295b0ee3a35dc4f50a627c51a3da4fe">calEH</a>, <a class="code" href="classCSpectrumData.html#a3df4b08f19dc399c7258c1f58063f121">calWL</a>, <a class="code" href="classCSpectrumData.html#a12b1698e9d0e4048270868630abb1036">calWH</a>;
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 
<a name="l00334"></a>00334         <span class="comment">//</span>
<a name="l00337"></a><a class="code" href="classCSpectrumData.html#acc551c43a27ec0448a0b24d53ddc2075">00337</a> <span class="comment"></span>        <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#acc551c43a27ec0448a0b24d53ddc2075" title="Concentration value (measured or userdefined).">conc</a>; 
<a name="l00338"></a>00338 
<a name="l00339"></a>00339         <span class="comment">// number of datapoints in spectrum</span>
<a name="l00340"></a><a class="code" href="classCSpectrumData.html#a4ad75480bbfcc126e5c33c47021cc393">00340</a>         <span class="keywordtype">int</span> <a class="code" href="classCSpectrumData.html#a4ad75480bbfcc126e5c33c47021cc393">wcount</a>;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342         <span class="comment">// minimum and maximum wavelengths</span>
<a name="l00343"></a><a class="code" href="classCSpectrumData.html#ae983387d5ee053605067fcd9c6de834d">00343</a>         <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#ae983387d5ee053605067fcd9c6de834d">wmin</a>,<a class="code" href="classCSpectrumData.html#a6f3d5bafa576e363c7cee48c2fd2612f">wmax</a>;
<a name="l00344"></a>00344 
<a name="l00345"></a>00345         <span class="comment">// minimum and maximum intensity values</span>
<a name="l00346"></a><a class="code" href="classCSpectrumData.html#a3d8c558ec07ad4a7bb1f713810b823c1">00346</a>         <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a3d8c558ec07ad4a7bb1f713810b823c1">imin</a>,<a class="code" href="classCSpectrumData.html#a00501108e9e51562df5bbe3fefdcd929">imax</a>;
<a name="l00347"></a>00347 
<a name="l00348"></a>00348         <span class="comment">// @@@ implement acquisition parameters ...</span>
<a name="l00349"></a>00349         <span class="comment">// integration time used</span>
<a name="l00350"></a><a class="code" href="classCSpectrumData.html#a925dd53b846689dfbb4dfc45d259c7e9">00350</a>         <span class="keywordtype">double</span> <a class="code" href="classCSpectrumData.html#a925dd53b846689dfbb4dfc45d259c7e9">itime</a>; <span class="comment">//ms</span>
<a name="l00351"></a><a class="code" href="classCSpectrumData.html#af150a81336f7f2b38f273b9afbaed5c3">00351</a>         <span class="keywordtype">int</span> <a class="code" href="classCSpectrumData.html#af150a81336f7f2b38f273b9afbaed5c3">avg</a>;
<a name="l00352"></a><a class="code" href="classCSpectrumData.html#a77d71cf442dabd538a5d8cbdc0c8ab5e">00352</a>         <span class="keywordtype">int</span> <a class="code" href="classCSpectrumData.html#a77d71cf442dabd538a5d8cbdc0c8ab5e">boxw</a>;
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 };
<a name="l00355"></a>00355 
<a name="l00357"></a>00357 <span class="comment">//</span>
<a name="l00360"></a><a class="code" href="classCDSpectrumData.html">00360</a> <span class="comment"></span><span class="keyword">class </span><a class="code" href="classCDSpectrumData.html" title="Class to hold a &amp;quot;data&amp;quot; spectrum.">CDSpectrumData</a>
<a name="l00361"></a>00361 {
<a name="l00362"></a>00362 <span class="keyword">public</span>:
<a name="l00363"></a>00363         <a class="code" href="classCDSpectrumData.html#a70072450e46cc86cdd9414e09d4c041e">CDSpectrumData</a>(<span class="keywordtype">void</span>);
<a name="l00364"></a>00364         <a class="code" href="classCDSpectrumData.html#a67811669ebf4b9c6d2191320de1d98ea">~CDSpectrumData</a>(<span class="keywordtype">void</span>);
<a name="l00365"></a>00365 
<a name="l00366"></a>00366         <span class="comment">//@name I/O functions</span>
<a name="l00368"></a>00368 <span class="comment"></span>
<a name="l00369"></a>00369         <span class="keywordtype">bool</span> <a class="code" href="classCDSpectrumData.html#a1bc0205c8aa9c6ebe15954dbd2e847aa" title="Save to file.">Save</a>(CString *filename);
<a name="l00370"></a>00370 
<a name="l00372"></a>00372         <span class="keywordtype">bool</span> <a class="code" href="classCDSpectrumData.html#ad748452cc3b1a7144d01cac1d114f112" title="Load from file.">Load</a>(CString *filename);
<a name="l00373"></a>00373 
<a name="l00376"></a><a class="code" href="classCDSpectrumData.html#a910af6c1fe89fdda34d1dfc97f5cbed4">00376</a>         <a class="code" href="classCSpectrumData.html" title="Class to hold spectrum data.">CSpectrumData</a> <a class="code" href="classCDSpectrumData.html#a910af6c1fe89fdda34d1dfc97f5cbed4">specBaseline</a>;
<a name="l00377"></a><a class="code" href="classCDSpectrumData.html#aa41bef09f10b5b025fd102284893c60e">00377</a>         <a class="code" href="classCSpectrumData.html" title="Class to hold spectrum data.">CSpectrumData</a> <a class="code" href="classCDSpectrumData.html#aa41bef09f10b5b025fd102284893c60e">specRaw</a>;
<a name="l00378"></a><a class="code" href="classCDSpectrumData.html#a37814cb5808f3445fc9bee05547d4a95">00378</a>         <a class="code" href="classCSpectrumData.html" title="Class to hold spectrum data.">CSpectrumData</a> <a class="code" href="classCDSpectrumData.html#a37814cb5808f3445fc9bee05547d4a95">specDiff</a>;
<a name="l00379"></a>00379 
<a name="l00381"></a><a class="code" href="classCDSpectrumData.html#a8929501647ef7e4adf88dc9b22ce9592">00381</a>         <span class="keywordtype">bool</span> <a class="code" href="classCDSpectrumData.html#a8929501647ef7e4adf88dc9b22ce9592" title="Is this spectrum highlighted / bold.">highlight</a>;
<a name="l00382"></a>00382 
<a name="l00384"></a><a class="code" href="classCDSpectrumData.html#adcfd9086f45d3809b7ad12cf30469786">00384</a>         CString <a class="code" href="classCDSpectrumData.html#adcfd9086f45d3809b7ad12cf30469786" title="Filename for use in review dialog bar.">specFileName</a>;
<a name="l00385"></a>00385 
<a name="l00386"></a>00386 
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 <span class="comment">//      static inline double getPipeKm() { return specDiff.getPipeKm(); }</span>
<a name="l00389"></a>00389 <span class="comment">//      static inline CSpectrumData getDiffSpecConst() { return static_cast&lt;const CSpectrumData&gt;(specDiff); }</span>
<a name="l00390"></a>00390 };
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Dec 6 2011 17:24:58 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
